var Globals=(function(){function a(){}a.initEnv=function(){this.env=nunjucks.configure({});this.env.addFilter("toFixed",function(b,c){return parseFloat(b).toFixed(c||2)});this.env.addFilter("cut",function(c,b){return c.substring(0,b||8)})};return a}());var Templates=(function(){function a(){}a.loadTemplates=function(){var b=true;this.testList=Globals.env.getTemplate("templates/test-list.njk",b);this.lineTooltip=Globals.env.getTemplate("templates/line-tooltip.njk",b);this.barTooltip=Globals.env.getTemplate("templates/bar-tooltip.njk",b);this.chart=Globals.env.getTemplate("templates/chart.njk",b);this.emptyResults=Globals.env.getTemplate("templates/empty-results.njk",b);this.toggleOption=Globals.env.getTemplate("templates/toggle-option.njk",b)};return a}());$(document).ready(function(){Globals.initEnv();Templates.loadTemplates();var c=false;$(document).keydown(function(d){if(d.which==17){c=true}});$(document).keyup(function(d){c=false});var b=function(){var e=[];var d=$("#options .cihpc-option");d.each(function(g,i){var f=$(i);var j=f.attr("checked")=="checked"?1:0;var h=$(i).attr("cihpc-option-name");e.push(h+"="+j)});return e.join(",")};var a=window.cihpc.flaskApiUrl+"/"+window.cihpc.projectName;$.ajax({url:a+"/config",success:function(e){document.title=e.name;if(e["test-view"].colorby){$("#options").html(Templates.toggleOption.render({name:"separate",text:"Show separately"}));window.componentHandler.upgradeDom("MaterialCheckbox");$("#checkbox-separate").change(function(i){})}var g=function(m){if(c){return false}var o=null,j=null;for(var n=0,l=this.points;n<l.length;n++){var k=l[n];var i=k.point.index;var o=k.series.options.commits[i];var j=k.point.name;break}return Templates.lineTooltip.render({commit:o,date:j,points:this.points})};var h=function(j){if(c){return false}var o=[];var q="";for(var l=0,n=this.points;l<n.length;l++){var k=n[l];var m=k.point.index;var p=k.series.options.data[m].path;var i=k.series.options.data[m].name;break}return Templates.barTooltip.render({path:p.split("/").join("<br />"),name:i,points:this.points,props:e["frame-view"].groupby})};var f=function(i,j){$.ajax({url:a+"/case-view-detail/"+(i.join(","))+"",success:function(k){k.xAxis["labels"]={formatter:function(){return this.value.substring(0,24)}};k.tooltip.formatter=h;$("#"+j).parent().removeClass("full-width");$("#"+j+"-detail").parent().removeClass("hidden");$("#"+j).highcharts().setSize(undefined,undefined);Highcharts.chart(j+"-detail",k)}})};var d=function(i,m,l){if(l){var j="mdl-button--raised";$(".testItem").removeClass(j);$(l).addClass(j)}$("#chartsHolder").empty();$("#loading").removeClass("hidden");var k="ff=test-name="+i+",ff=case-name="+m+","+b();$.ajax({url:a+"/case-view/"+k,success:function(q){$("#loading").addClass("hidden");$("#chartTitle").html(i+" / "+m);if(!Array.isArray(q)){$("#warning-msg .fs-inner-container").html(Templates.emptyResults.render(q));$("#warning-msg").removeClass("hidden");$("#page-content").addClass("hidden");return}$("#warning-msg").addClass("hidden");$("#page-content").removeClass("hidden");for(var p in q){var o=q[p].size;var n=q[p].data;var r="chart-"+(Number(p)+1);$("#chartsHolder").append(Templates.chart.render({testName:i,caseName:m,id:r}));n.xAxis.labels={useHTML:true,formatter:function(){var t=this.axis.series[0].options.commits[this.pos];var s=e["git-url"]+"/commit/"+t;return'<a href="'+s+'" target="_blank">'+this.value+"</a>"},events:{click:function(){}}};for(var p in n.series){if(!n.series[p].point){continue}n.series[p].point.events={select:function(t){var u=this.series.chart.renderTo.getAttribute("id");var z=$("#"+u).highcharts();var B=z.getSelectedPoints();B.push(this);var v=[];for(var w=0,A=B;w<A.length;w++){var C=A[w];var y=C.index;var x=C.series.userOptions.commits[y];var s=C.series.userOptions.uuids[y];v.push(s)}f(v,u)}}}n.tooltip.formatter=g;Highcharts.chart(r,n)}}})};$("#testsRendered").html(Templates.testList.render({title:e.name,tests:e.tests}));window.showChart=d;window.showChartDetail=f}})});