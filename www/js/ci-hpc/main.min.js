var Globals=(function(){function a(){}a.initEnv=function(){this.env=nunjucks.configure({});this.env.addFilter("toFixed",function(b,c){return parseFloat(b).toFixed(c||2)});this.env.addFilter("cut",function(c,b){return c.substring(0,b||8)})};return a}());var Templates=(function(){function a(){}a.loadTemplates=function(){var b=true;this.testList=Globals.env.getTemplate("templates/test-list.njk",b);this.lineTooltip=Globals.env.getTemplate("templates/line-tooltip.njk",b);this.barTooltip=Globals.env.getTemplate("templates/bar-tooltip.njk",b);this.chart=Globals.env.getTemplate("templates/chart.njk",b);this.emptyResults=Globals.env.getTemplate("templates/empty-results.njk",b);this.toggleOption=Globals.env.getTemplate("templates/toggle-option.njk",b)};return a}());$(document).ready(function(){Globals.initEnv();Templates.loadTemplates();var c=false;$(document).keydown(function(d){if(d.which==17){c=true}});$(document).keyup(function(d){c=false});var b=function(){var e=[];var d=$("#options .cihpc-option");d.each(function(g,i){var f=$(i);var j=f.attr("checked")=="checked"?1:0;var h=$(i).attr("cihpc-option-name");e.push(h+"="+j)});return e.join(",")};var a=window.cihpc.flaskApiUrl+"/"+window.cihpc.projectName;$.ajax({url:a+"/config",success:function(e){document.title=e.name;if(e["test-view"].colorby){$("#options").html(Templates.toggleOption.render({name:"separate",text:"Show separately"}));window.componentHandler.upgradeDom("MaterialCheckbox");$("#checkbox-separate").change(function(i){})}var g=function(m){if(c){return false}var o=null,j=null;for(var n=0,l=this.points;n<l.length;n++){var k=l[n];if(!o){var i=k.point.index;o=k.series.options.commits[i];j=k.point.name}}return Templates.lineTooltip.render({commit:o,date:j,points:this.points})};var h=function(j){if(c){return false}var o=[];var q="";for(var l=0,n=this.points;l<n.length;l++){var k=n[l];var m=k.point.index;var p=k.series.options.data[m].path;var i=k.series.options.data[m].name;break}return Templates.barTooltip.render({path:p.split("/").join("<br />"),name:i,points:this.points})};var f=function(i,j){$.ajax({url:a+"/case-view-detail/"+(i.join(","))+"",success:function(k){k.xAxis["labels"]={formatter:function(){return this.value.substring(0,24)}};k.tooltip.formatter=function(m){if(c){return false}var r=[];var t="";for(var o=0,q=this.points;o<q.length;o++){var n=q[o];var p=n.point.index;var s=n.series.options.data[p].path;var l=n.series.options.data[p].name;break}return Templates.barTooltip.render({path:s.split("/").join("<br />"),name:l,points:this.points})};$("#"+j).parent().removeClass("full-width");$("#"+j+"-detail").parent().removeClass("hidden");$("#"+j).highcharts().setSize(undefined,undefined);Highcharts.chart(j+"-detail",k)}})};var d=function(i,l,k){if(k){var j="mdl-button--raised";$(".testItem").removeClass(j);$(k).addClass(j)}$("#chartsHolder").empty();$.ajax({url:a+"/case-view/"+i+"/"+l+"/"+b(),success:function(p){$("#chartTitle").html(i+" / "+l);if(!Array.isArray(p)){$("#warning-msg .fs-inner-container").html(Templates.emptyResults.render(p));$("#warning-msg").removeClass("hidden");$("#page-content").addClass("hidden");return}$("#warning-msg").addClass("hidden");$("#page-content").removeClass("hidden");for(var o in p){var n=p[o].size;var m=p[o].data;var q="chart-"+(Number(o)+1);$("#chartsHolder").append(Templates.chart.render({testName:i,caseName:l,id:q}));m.xAxis.labels={useHTML:true,formatter:function(){var s=this.axis.series[0].options.commits[this.pos];var r=e["git-url"]+"/commit/"+s;return'<a href="'+r+'" target="_blank">'+this.value+"</a>"},events:{click:function(){}}};for(var o in m.series){if(!m.series[o].point){continue}m.series[o].point.events={select:function(s){var t=this.series.chart.renderTo.getAttribute("id");var y=$("#"+t).highcharts();var A=y.getSelectedPoints();A.push(this);var u=[];for(var v=0,z=A;v<z.length;v++){var B=z[v];var x=B.index;var w=B.series.userOptions.commits[x];var r=B.series.userOptions.uuids[x];u.push(r)}f(u,t)}}}m.tooltip.formatter=g;Highcharts.chart(q,m)}}})};$("#testsRendered").html(Templates.testList.render({title:e.name,tests:e.tests}));window.showChart=d;window.showChartDetail=f}})});